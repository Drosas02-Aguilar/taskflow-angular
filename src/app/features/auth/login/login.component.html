<div class="bg-shape shape-1"></div>
<div class="bg-shape shape-2"></div>

<div class="card-container">
  <div class="card-login">
    <!-- Logo -->
    <div class="logo-container">
      <div class="logo-icon">
        <i class="bi bi-check2-circle"></i>
      </div>
      <h1 class="title">TaskFlow</h1>
      <p class="subtitle">Gestiona tus tareas de forma eficiente</p>
    </div>

    <!-- Alertas -->
    @if (successMessage()) {
      <div class="alert alert-success">
        <i class="bi bi-check-circle-fill me-2"></i>
        <span>{{ successMessage() }}</span>
      </div>
    }

    @if (errorMessage()) {
      <div class="alert alert-danger">
        <i class="bi bi-exclamation-circle-fill me-2"></i>
        <span>{{ errorMessage() }}</span>
      </div>
    }

    <!-- Formulario -->
    <form [formGroup]="loginForm" (ngSubmit)="onSubmit()">
      <!-- Username -->
      <div class="form-floating mb-3">
        <i class="bi bi-person-fill input-icon"></i>
        <input 
          type="text" 
          class="form-control" 
          id="username" 
          formControlName="username" 
          placeholder="Usuario"
          [class.is-invalid]="isFieldInvalid('username')">
        <label for="username">Usuario</label>
      </div>

      <!-- Password -->
      <div class="form-floating mb-3 position-relative">
        <i class="bi bi-lock-fill input-icon"></i>
        <input 
          [type]="showPassword() ? 'text' : 'password'" 
          class="form-control" 
          id="password" 
          formControlName="password" 
          placeholder="Contraseña"
          [class.is-invalid]="isFieldInvalid('password')">
        <label for="password">Contraseña</label>
        <i 
          class="bi password-toggle" 
          [class.bi-eye-fill]="!showPassword()" 
          [class.bi-eye-slash-fill]="showPassword()" 
          (click)="togglePassword()">
        </i>
      </div>

      <!-- Forgot password -->
      <div class="text-end mb-3">
        <a routerLink="/auth/forgot" class="link-forgot">¿Olvidaste tu contraseña?</a>
      </div>

      <!-- Submit button -->
      <button type="submit" class="btn-primary-custom" [disabled]="loading()">
        @if (loading()) {
          <span class="spinner-border spinner-border-sm me-2"></span>
          Iniciando sesión...
        } @else {
          <i class="bi bi-box-arrow-in-right me-2"></i>
          Iniciar Sesión
        }
      </button>
    </form>

    <!-- Register link -->
    <div class="register-link">
      <span>¿No tienes cuenta?</span>
      <a routerLink="/auth/register">Regístrate aquí</a>
    </div>
  </div>
</div>